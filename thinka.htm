<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thinka â€” Explore</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400;1,700&family=Manrope:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

:root {
  --cream:  #f7f3ee;
  --ink:    #16120d;
  --ink2:   #3d3628;
  --ember:  #e8560a;
  --ember2: #f5812e;
  --muted:  rgba(22,18,13,0.45);
  --faint:  rgba(22,18,13,0.06);

  --c-rd:   #e8560a;   /* R&D â€” ember */
  --c-re:   #2a7de1;   /* Researchers â€” blue */
  --c-in:   #0a8a6e;   /* Industry â€” teal */
  --c-co:   #7c3aed;   /* Collaboration â€” violet */
}

html, body {
  width:100%; height:100%;
  background: var(--cream);
  color: var(--ink);
  font-family: 'Manrope', sans-serif;
  overflow: hidden;
}

/* â”€â”€ Canvas layer â”€â”€ */
#bg-canvas {
  position:fixed; inset:0; z-index:0;
  transition: opacity 0.6s ease;
}

/* â”€â”€ Shell â”€â”€ */
.shell {
  position:relative; z-index:10;
  height:100vh;
  display:grid;
  grid-template-rows: auto 1fr auto;
  padding: 36px 52px;
}

/* â”€â”€ Header â”€â”€ */
header {
  display:flex; justify-content:space-between; align-items:center;
  animation: up 0.8s 0.1s ease both;
}

.brand {
  display:flex; align-items:center; gap:12px;
}

.brand-mark {
  width:36px; height:36px;
  background: var(--ink);
  border-radius:8px;
  display:flex; align-items:center; justify-content:center;
  flex-shrink:0;
}
.brand-mark svg { width:18px; height:18px; }

.brand-text { display:flex; flex-direction:column; gap:1px; }
.brand-product {
  font-family:'Playfair Display', serif;
  font-size:18px; font-weight:700;
  letter-spacing:-0.01em;
  color:var(--ink);
  line-height:1;
}
.brand-company {
  font-size:10px; font-weight:500;
  letter-spacing:0.12em; text-transform:uppercase;
  color:var(--muted);
}

.back-btn {
  font-size:11px; font-weight:600;
  letter-spacing:0.14em; text-transform:uppercase;
  color:var(--muted);
  background:none; border:1.5px solid rgba(22,18,13,0.15);
  padding:8px 18px; border-radius:50px;
  cursor:pointer;
  transition:all 0.25s;
  text-decoration:none;
  display:flex; align-items:center; gap:7px;
}
.back-btn:hover { border-color:var(--ember); color:var(--ember); }
.back-btn svg { width:12px; height:12px; }

/* â”€â”€ Tab nav â”€â”€ */
.tab-nav {
  display:flex; justify-content:center; align-items:center;
  gap:8px;
  animation: up 0.8s 0.25s ease both;
}

.tab-btn {
  font-family:'Manrope', sans-serif;
  font-size:11px; font-weight:600;
  letter-spacing:0.12em; text-transform:uppercase;
  padding:10px 22px;
  border-radius:50px;
  border:1.5px solid rgba(22,18,13,0.12);
  background:transparent;
  color:var(--muted);
  cursor:pointer;
  transition:all 0.3s cubic-bezier(0.34,1.56,0.64,1);
  position:relative;
  overflow:hidden;
  pointer-events:auto;
  z-index:15;
}

.tab-btn::before {
  content:'';
  position:absolute; inset:0;
  border-radius:50px;
  opacity:0;
  transition:opacity 0.3s;
}

.tab-btn.active {
  color:#fff;
  border-color:transparent;
  transform:scale(1.04);
  box-shadow:0 8px 24px rgba(0,0,0,0.15);
}

.tab-btn[data-tab="rd"].active       { background:var(--c-rd); }
.tab-btn[data-tab="researchers"].active { background:var(--c-re); }
.tab-btn[data-tab="industry"].active  { background:var(--c-in); }
.tab-btn[data-tab="collab"].active    { background:var(--c-co); }

/* â”€â”€ Main content â”€â”€ */
.main {
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  position:relative;
}

/* â”€â”€ Panels â”€â”€ */
.panel {
  position:absolute;
  width:100%;
  max-width:780px;
  text-align:center;
  opacity:0;
  transform:translateY(30px) scale(0.97);
  pointer-events:none;
  transition:opacity 0.5s ease, transform 0.5s ease;
}

.panel.active {
  opacity:1;
  transform:translateY(0) scale(1);
  pointer-events:all;
}

.panel-icon {
  width:72px; height:72px;
  border-radius:20px;
  display:flex; align-items:center; justify-content:center;
  margin:0 auto 28px;
  font-size:32px;
}

.panel-eyebrow {
  font-size:10px; font-weight:700;
  letter-spacing:0.28em; text-transform:uppercase;
  margin-bottom:16px;
}

.panel-title {
  font-family:'Playfair Display', serif;
  font-size:clamp(40px, 6vw, 72px);
  font-weight:900;
  line-height:0.92;
  letter-spacing:-0.03em;
  color:var(--ink);
  margin-bottom:24px;
}

.panel-title em {
  font-style:italic;
  display:block;
}

.panel-desc {
  font-size:clamp(14px, 1.4vw, 16px);
  font-weight:300;
  line-height:1.85;
  color:var(--muted);
  max-width:520px;
  margin:0 auto 36px;
}
.panel-desc strong { color:var(--ink2); font-weight:500; }

/* Feature chips */
.features {
  display:flex; flex-wrap:wrap;
  justify-content:center;
  gap:10px;
  margin-bottom:36px;
}

.feat {
  font-size:12px; font-weight:500;
  letter-spacing:0.06em;
  padding:8px 18px;
  border-radius:50px;
  background:var(--faint);
  color:var(--ink2);
  border:1.5px solid rgba(22,18,13,0.08);
  transition:all 0.25s;
  cursor:default;
}

.feat:hover {
  transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(0,0,0,0.08);
}

/* CTA */
.panel-cta {
  display:inline-flex; align-items:center; gap:10px;
  font-size:12px; font-weight:700;
  letter-spacing:0.14em; text-transform:uppercase;
  color:#fff;
  padding:13px 28px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  transition:transform 0.2s, box-shadow 0.2s;
}
.panel-cta:hover {
  transform:translateY(-2px);
  box-shadow:0 12px 32px rgba(0,0,0,0.2);
}
.panel-cta svg { width:14px; height:14px; }

/* Panel color theming */
.panel[data-panel="rd"] .panel-eyebrow    { color:var(--c-rd); }
.panel[data-panel="rd"] .panel-icon       { background:rgba(232,86,10,0.1); }
.panel[data-panel="rd"] .panel-cta        { background:var(--c-rd); }
.panel[data-panel="rd"] .feat:hover       { background:rgba(232,86,10,0.08); border-color:rgba(232,86,10,0.3); color:var(--c-rd); }

.panel[data-panel="researchers"] .panel-eyebrow { color:var(--c-re); }
.panel[data-panel="researchers"] .panel-icon    { background:rgba(42,125,225,0.1); }
.panel[data-panel="researchers"] .panel-cta     { background:var(--c-re); }
.panel[data-panel="researchers"] .feat:hover    { background:rgba(42,125,225,0.08); border-color:rgba(42,125,225,0.3); color:var(--c-re); }

.panel[data-panel="industry"] .panel-eyebrow  { color:var(--c-in); }
.panel[data-panel="industry"] .panel-icon     { background:rgba(10,138,110,0.1); }
.panel[data-panel="industry"] .panel-cta      { background:var(--c-in); }
.panel[data-panel="industry"] .feat:hover     { background:rgba(10,138,110,0.08); border-color:rgba(10,138,110,0.3); color:var(--c-in); }

.panel[data-panel="collab"] .panel-eyebrow  { color:var(--c-co); }
.panel[data-panel="collab"] .panel-icon     { background:rgba(124,58,237,0.1); }
.panel[data-panel="collab"] .panel-cta      { background:var(--c-co); }
.panel[data-panel="collab"] .feat:hover     { background:rgba(124,58,237,0.08); border-color:rgba(124,58,237,0.3); color:var(--c-co); }

/* â”€â”€ Footer â”€â”€ */
footer {
  display:flex; justify-content:center; align-items:center;
  gap:6px;
  animation: up 0.8s 0.4s ease both;
}

.step-dot {
  width:6px; height:6px; border-radius:50%;
  background:rgba(22,18,13,0.15);
  transition:all 0.3s;
  cursor:pointer;
}
.step-dot.active {
  width:20px; border-radius:3px;
  background:var(--ink);
}

/* â”€â”€ Animations â”€â”€ */
@keyframes up {
  from { opacity:0; transform:translateY(16px); }
  to   { opacity:1; transform:translateY(0); }
}

/* â”€â”€ Responsive â”€â”€ */
@media(max-width:640px){
  .shell { padding:24px 20px; }
  .tab-btn { font-size:9px; padding:8px 14px; }
  .brand-company { display:none; }
}
</style>
</head>
<body>

<canvas id="bg-canvas"></canvas>

<div class="shell">

  <!-- Header -->
  <header>
    <div class="brand">
      <div class="brand-mark">
        <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="28.5" y="22" width="7" height="30" rx="3.5" fill="white"/>
          <rect x="10" y="14" width="20" height="7" rx="3.5" fill="white"/>
          <rect x="34" y="14" width="20" height="7" rx="3.5" fill="white"/>
          <circle cx="14" cy="17.5" r="5.5" fill="#e8560a"/>
          <circle cx="14" cy="17.5" r="3" fill="#16120d"/>
          <circle cx="50" cy="17.5" r="5.5" fill="#e8560a"/>
          <circle cx="50" cy="17.5" r="3" fill="#16120d"/>
          <circle cx="32" cy="17.5" r="4" fill="#e8560a"/>
        </svg>
      </div>
      <div class="brand-text">
        <span class="brand-product">Thinka</span>
        <span class="brand-company">by ResearchCamp</span>
      </div>
    </div>

    <nav class="tab-nav">
      <button class="tab-btn active" data-tab="rd">R&amp;D Projects</button>
      <button class="tab-btn" data-tab="researchers">Researchers</button>
      <button class="tab-btn" data-tab="industry">Industry Clients</button>
      <button class="tab-btn" data-tab="collab">Collaboration</button>
    </nav>

    <a class="back-btn" href="index.html">
      <svg viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M8 2L4 6l4 4"/>
      </svg>
      Back
    </a>
  </header>

  <!-- Main -->
  <div class="main">

    <!-- R&D Projects -->
    <div class="panel active" data-panel="rd">
      <div class="panel-icon">ğŸ”¬</div>
      <div class="panel-eyebrow">Pillar 01 â€” R&amp;D Projects</div>
      <h2 class="panel-title">
        Research that
        <em>builds things.</em>
      </h2>
      <p class="panel-desc">
        Thinka hosts <strong>live R&amp;D projects</strong> across industries â€” from biotech to clean energy.
        Every project is scoped, funded, and ready for the right research minds to take on.
        Turn academic expertise into <strong>real-world outcomes</strong>.
      </p>
      <div class="features">
        <span class="feat">Project Matching</span>
        <span class="feat">Milestone Tracking</span>
        <span class="feat">IP Protection</span>
        <span class="feat">Funded Briefs</span>
        <span class="feat">Cross-domain R&amp;D</span>
        <span class="feat">Outcome Reporting</span>
      </div>
      <button class="panel-cta">
        Explore Projects
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 7h10M8 3l4 4-4 4"/></svg>
      </button>
    </div>

    <!-- Researchers -->
    <div class="panel" data-panel="researchers">
      <div class="panel-icon">ğŸ§ª</div>
      <div class="panel-eyebrow">Pillar 02 â€” Researchers</div>
      <h2 class="panel-title">
        Your expertise,
        <em>amplified.</em>
      </h2>
      <p class="panel-desc">
        Whether you're a PhD candidate, postdoc, or tenured professor â€”
        Thinka connects you with <strong>industry partners who need your knowledge</strong>.
        Get paid for your research. Build your portfolio. <strong>Make an impact beyond the lab.</strong>
      </p>
      <div class="features">
        <span class="feat">Verified Profiles</span>
        <span class="feat">Project Discovery</span>
        <span class="feat">Fair Compensation</span>
        <span class="feat">Academic Freedom</span>
        <span class="feat">Publication Rights</span>
        <span class="feat">Peer Network</span>
      </div>
      <button class="panel-cta">
        Join as Researcher
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 7h10M8 3l4 4-4 4"/></svg>
      </button>
    </div>

    <!-- Industry Clients -->
    <div class="panel" data-panel="industry">
      <div class="panel-icon">ğŸ­</div>
      <div class="panel-eyebrow">Pillar 03 â€” Industry Clients</div>
      <h2 class="panel-title">
        The research lab
        <em>you never had.</em>
      </h2>
      <p class="panel-desc">
        Post your R&amp;D challenge and get matched with <strong>world-class researchers</strong>
        who can solve it. From product innovation to scientific validation â€”
        Thinka is your <strong>on-demand research partner</strong>, without the overhead.
      </p>
      <div class="features">
        <span class="feat">Project Posting</span>
        <span class="feat">Researcher Vetting</span>
        <span class="feat">NDAs &amp; Contracts</span>
        <span class="feat">Progress Dashboards</span>
        <span class="feat">Cost Efficiency</span>
        <span class="feat">Scalable R&amp;D</span>
      </div>
      <button class="panel-cta">
        Post a Project
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 7h10M8 3l4 4-4 4"/></svg>
      </button>
    </div>

    <!-- Collaboration -->
    <div class="panel" data-panel="collab">
      <div class="panel-icon">ğŸ¤</div>
      <div class="panel-eyebrow">Pillar 04 â€” Collaboration</div>
      <h2 class="panel-title">
        Where two worlds
        <em>become one.</em>
      </h2>
      <p class="panel-desc">
        Thinka's collaboration layer is where the magic happens â€”
        <strong>shared workspaces, milestone reviews, real-time communication</strong>,
        and structured handoffs that keep every project moving forward.
        Research and industry, <strong>finally in sync.</strong>
      </p>
      <div class="features">
        <span class="feat">Shared Workspaces</span>
        <span class="feat">Milestone Reviews</span>
        <span class="feat">Live Messaging</span>
        <span class="feat">File Sharing</span>
        <span class="feat">Video Calls</span>
        <span class="feat">Joint Reporting</span>
      </div>
      <button class="panel-cta">
        See How It Works
        <svg viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M2 7h10M8 3l4 4-4 4"/></svg>
      </button>
    </div>

  </div>

  <!-- Footer dots -->
  <footer>
    <div class="step-dot active" data-dot="rd"></div>
    <div class="step-dot" data-dot="researchers"></div>
    <div class="step-dot" data-dot="industry"></div>
    <div class="step-dot" data-dot="collab"></div>
  </footer>

</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// 4D CANVAS ENGINE
// Each tab has its own particle universe with depth (z-axis)
// projected onto 2D with perspective â€” true 4D feel
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const canvas = document.getElementById('bg-canvas');
const ctx = canvas.getContext('2d');
let W, H, animId;
let currentMode = 'rd';
let transitionAlpha = 1;

const MODES = {
  rd: {
    color1: [232, 86, 10],
    color2: [245, 129, 46],
    bg: '#f7f3ee',
    type: 'molecules',    // orbiting molecular bonds
  },
  researchers: {
    color1: [42, 125, 225],
    color2: [100, 180, 255],
    bg: '#f0f4fc',
    type: 'neural',       // neural network flowing leftâ†’right
  },
  industry: {
    color1: [10, 138, 110],
    color2: [60, 200, 160],
    bg: '#f0faf6',
    type: 'grid',         // 3D perspective grid rising
  },
  collab: {
    color1: [124, 58, 237],
    color2: [180, 130, 255],
    bg: '#f5f0ff',
    type: 'vortex',       // dual vortex spiraling toward center
  }
};

function resize() {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MOLECULES â€” R&D (orbiting atoms/bonds)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function makeMolecules() {
  const atoms = [];
  const count = 18;
  for (let i = 0; i < count; i++) {
    const cx = W * (0.1 + Math.random() * 0.8);
    const cy = H * (0.1 + Math.random() * 0.8);
    const z  = Math.random() * 800 + 100;
    const orbitR = 30 + Math.random() * 60;
    const orbitSpeed = (Math.random() - 0.5) * 0.008;
    const orbitAngle = Math.random() * Math.PI * 2;
    const electrons = Math.floor(Math.random() * 3) + 1;
    atoms.push({ cx, cy, z, orbitR, orbitSpeed, orbitAngle, electrons });
  }
  return { atoms };
}

function drawMolecules(state, t, [r,g,b]) {
  const { atoms } = state;
  const fov = 600;

  atoms.forEach(atom => {
    atom.orbitAngle += atom.orbitSpeed;
    const scale = fov / (fov + atom.z);
    const ax = atom.cx, ay = atom.cy;

    // Nucleus
    ctx.beginPath();
    ctx.arc(ax, ay, 5 * scale, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(${r},${g},${b},${0.5 * scale})`;
    ctx.fill();

    // Electrons orbiting
    for (let e = 0; e < atom.electrons; e++) {
      const eAngle = atom.orbitAngle + (e / atom.electrons) * Math.PI * 2;
      const ex = ax + Math.cos(eAngle) * atom.orbitR * scale;
      const ey = ay + Math.sin(eAngle) * atom.orbitR * scale * 0.5;

      // Bond line
      ctx.beginPath();
      ctx.moveTo(ax, ay);
      ctx.lineTo(ex, ey);
      ctx.strokeStyle = `rgba(${r},${g},${b},${0.12 * scale})`;
      ctx.lineWidth = 1;
      ctx.stroke();

      // Electron
      ctx.beginPath();
      ctx.arc(ex, ey, 3 * scale, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(${r},${g},${b},${0.7 * scale})`;
      ctx.fill();
    }
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// NEURAL â€” Researchers (flowing network)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function makeNeural() {
  const nodes = [];
  const cols = 7, rows = 5;
  for (let c = 0; c < cols; c++) {
    for (let r2 = 0; r2 < rows; r2++) {
      nodes.push({
        bx: (c / (cols-1)) * W,
        by: (r2 / (rows-1)) * H,
        z: Math.random() * 600 + 100,
        phase: Math.random() * Math.PI * 2,
        speed: 0.3 + Math.random() * 0.5,
        col: c, row: r2,
        active: false,
        activeTimer: 0,
      });
    }
  }
  // Trigger random activations
  return { nodes, fireTimer: 0 };
}

function drawNeural(state, t, [r,g,b]) {
  const { nodes } = state;
  const fov = 600;

  state.fireTimer++;
  if (state.fireTimer > 40) {
    const n = nodes[Math.floor(Math.random() * nodes.length)];
    n.active = true; n.activeTimer = 0;
    state.fireTimer = 0;
  }

  nodes.forEach(n => {
    if (n.active) {
      n.activeTimer++;
      if (n.activeTimer > 30) n.active = false;
    }

    const scale = fov / (fov + n.z);
    const nx = n.bx + Math.sin(t * n.speed + n.phase) * 18;
    const ny = n.by + Math.cos(t * n.speed * 0.7 + n.phase) * 12;
    n._x = nx; n._y = ny; n._scale = scale;
  });

  // Draw connections (forward-flowing only)
  nodes.forEach((n, i) => {
    nodes.forEach((m, j) => {
      if (m.col !== n.col + 1) return;
      const dx = n._x - m._x, dy = n._y - m._y;
      const d = Math.sqrt(dx*dx + dy*dy);
      if (d > H * 0.45) return;
      const alpha = (1 - d/(H*0.45)) * 0.12;
      ctx.beginPath();
      ctx.moveTo(n._x, n._y);
      ctx.lineTo(m._x, m._y);
      ctx.strokeStyle = `rgba(${r},${g},${b},${alpha})`;
      ctx.lineWidth = 0.8;
      ctx.stroke();
    });
  });

  // Draw nodes
  nodes.forEach(n => {
    const pulse = n.active ? (1 + Math.sin(n.activeTimer * 0.4) * 0.5) : 1;
    const baseR = 4 * n._scale * pulse;

    if (n.active) {
      ctx.beginPath();
      ctx.arc(n._x, n._y, baseR * 3.5, 0, Math.PI*2);
      ctx.fillStyle = `rgba(${r},${g},${b},0.06)`;
      ctx.fill();
    }

    ctx.beginPath();
    ctx.arc(n._x, n._y, baseR, 0, Math.PI*2);
    ctx.fillStyle = n.active
      ? `rgba(${r},${g},${b},0.85)`
      : `rgba(${r},${g},${b},${0.25 * n._scale})`;
    ctx.fill();
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// GRID â€” Industry (3D perspective floor)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function makeGrid() {
  return { offset: 0 };
}

function drawGrid(state, t, [r,g,b]) {
  state.offset = (state.offset + 0.4) % 80;
  const cx = W/2, horizon = H * 0.42;
  const spread = W * 1.4;
  const depth = H * 0.7;
  const lines = 14;
  const cols = 16;

  // Vertical lines (perspective)
  for (let i = 0; i <= cols; i++) {
    const x0 = cx + (i/cols - 0.5) * spread;
    const alpha = 0.08 - Math.abs(i/cols - 0.5) * 0.12;
    ctx.beginPath();
    ctx.moveTo(x0, H);
    ctx.lineTo(cx + (i/cols - 0.5) * 40, horizon);
    ctx.strokeStyle = `rgba(${r},${g},${b},${Math.max(0.02,alpha)})`;
    ctx.lineWidth = 1;
    ctx.stroke();
  }

  // Horizontal lines (receding)
  for (let i = 0; i <= lines; i++) {
    const prog = (i / lines);
    const rawY = horizon + prog * depth + state.offset;
    if (rawY > H + 10) continue;
    const perspective = prog * prog;
    const x1 = cx - spread/2 * (0.05 + perspective * 0.95);
    const x2 = cx + spread/2 * (0.05 + perspective * 0.95);
    const alpha = perspective * 0.12;
    ctx.beginPath();
    ctx.moveTo(x1, rawY);
    ctx.lineTo(x2, rawY);
    ctx.strokeStyle = `rgba(${r},${g},${b},${alpha})`;
    ctx.lineWidth = 1;
    ctx.stroke();
  }

  // Rising data bars on grid intersections
  for (let c = 1; c < cols; c++) {
    for (let row = 2; row < lines - 1; row++) {
      const prog = (row / lines);
      const rawY = horizon + prog * depth + state.offset;
      if (rawY > H + 10 || rawY < horizon) continue;
      const x = cx + (c/cols - 0.5) * spread * (0.05 + prog * 0.95);
      const barH = (Math.sin(t * 0.5 + c * 0.8 + row * 1.2) * 0.5 + 0.5) * 22 * prog;
      const alpha = prog * 0.4;
      ctx.fillStyle = `rgba(${r},${g},${b},${alpha})`;
      ctx.fillRect(x - 1.5, rawY - barH, 3, barH);
    }
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// VORTEX â€” Collaboration (dual spirals)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function makeVortex() {
  const particles = [];
  for (let i = 0; i < 200; i++) {
    particles.push({
      angle: Math.random() * Math.PI * 2,
      radius: 80 + Math.random() * Math.min(W, H) * 0.3,
      z: Math.random() * 800 + 50,
      speed: (Math.random() * 0.006 + 0.002) * (Math.random() > 0.5 ? 1 : -1),
      side: Math.random() > 0.5 ? 1 : -1,
      size: Math.random() * 2 + 0.5,
    });
  }
  return { particles };
}

function drawVortex(state, t, [r,g,b]) {
  const { particles } = state;
  const fov = 600;
  const cx = W/2, cy = H/2;
  const spread = Math.min(W,H) * 0.18;

  particles.forEach(p => {
    p.angle += p.speed;
    const scale = fov / (fov + p.z);
    const centerX = cx + p.side * spread;
    const px = centerX + Math.cos(p.angle) * p.radius * scale;
    const py = cy   + Math.sin(p.angle) * p.radius * scale * 0.55;
    const alpha = 0.4 * scale;

    ctx.beginPath();
    ctx.arc(px, py, p.size * scale, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(${r},${g},${b},${alpha})`;
    ctx.fill();
  });

  // Center merge glow
  const glowR = 60 + Math.sin(t) * 10;
  const grd = ctx.createRadialGradient(cx, cy, 0, cx, cy, glowR);
  grd.addColorStop(0, `rgba(${r},${g},${b},0.12)`);
  grd.addColorStop(1, `rgba(${r},${g},${b},0)`);
  ctx.beginPath();
  ctx.arc(cx, cy, glowR, 0, Math.PI * 2);
  ctx.fillStyle = grd;
  ctx.fill();

  // Connecting arc between the two vortex centers
  ctx.beginPath();
  ctx.moveTo(cx - spread, cy);
  ctx.bezierCurveTo(
    cx - spread, cy - 60,
    cx + spread, cy - 60,
    cx + spread, cy
  );
  ctx.strokeStyle = `rgba(${r},${g},${b},0.1)`;
  ctx.lineWidth = 1.5;
  ctx.stroke();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MAIN LOOP
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let states = {};
let t = 0;
let targetBg = '#f7f3ee';
let currentBg = [247, 243, 238];

function hexToRgbArr(hex) {
  const r = parseInt(hex.slice(1,3),16);
  const g = parseInt(hex.slice(3,5),16);
  const b = parseInt(hex.slice(5,7),16);
  return [r, g, b];
}

function lerpColor(a, b, f) {
  return a.map((v,i) => Math.round(v + (b[i]-v)*f));
}

function initStates() {
  resize();
  states = {
    rd:          makeMolecules(),
    researchers: makeNeural(),
    industry:    makeGrid(),
    collab:      makeVortex(),
  };
}

function loop() {
  t += 0.016;
  const mode = MODES[currentMode];
  const targetArr = hexToRgbArr(mode.bg);
  currentBg = lerpColor(currentBg, targetArr, 0.04);

  ctx.fillStyle = `rgb(${currentBg[0]},${currentBg[1]},${currentBg[2]})`;
  ctx.fillRect(0, 0, W, H);

  const [r,g,b] = mode.color1;

  if (currentMode === 'rd')          drawMolecules(states.rd,          t, [r,g,b]);
  if (currentMode === 'researchers') drawNeural(states.researchers,    t, [r,g,b]);
  if (currentMode === 'industry')    drawGrid(states.industry,         t, [r,g,b]);
  if (currentMode === 'collab')      drawVortex(states.collab,         t, [r,g,b]);

  animId = requestAnimationFrame(loop);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// TAB SWITCHING
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const tabMap = {
  'rd':          'rd',
  'researchers': 'researchers',
  'industry':    'industry',
  'collab':      'collab',
};

function switchTo(key) {
  currentMode = key;

  // Tabs
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.tab === key);
  });

  // Panels
  document.querySelectorAll('.panel').forEach(p => {
    p.classList.toggle('active', p.dataset.panel === key);
  });

  // Dots
  document.querySelectorAll('.step-dot').forEach(d => {
    d.classList.toggle('active', d.dataset.dot === key);
  });
}

document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.addEventListener('click', () => switchTo(btn.dataset.tab));
});

document.querySelectorAll('.step-dot').forEach(d => {
  d.addEventListener('click', () => switchTo(d.dataset.dot));
});

// Keyboard nav
document.addEventListener('keydown', e => {
  const order = ['rd','researchers','industry','collab'];
  const idx = order.indexOf(currentMode);
  if (e.key === 'ArrowRight' && idx < order.length-1) switchTo(order[idx+1]);
  if (e.key === 'ArrowLeft'  && idx > 0)              switchTo(order[idx-1]);
});

window.addEventListener('resize', () => { resize(); initStates(); });

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HASH-BASED TAB ACTIVATION ON PAGE LOAD
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function handleHash() {
  const hash = window.location.hash.slice(1); // remove #
  const order = ['rd','researchers','industry','collab'];
  if (hash && order.includes(hash)) {
    switchTo(hash);
  }
}

window.addEventListener('hashchange', handleHash);

initStates();
loop();
handleHash();
</script>
</body>
</html>